Semantics for the running example consists of the "fraudMetric" and "participants" nodes.
The environment has three sources, two one-arity operations, and two two-arity operations.

We discussed earlier an abstract definition of the contracts using the type classes and the particular implementation. 
However, using this implementation, we cannot describe the required input data state of the fraud metric, which works on the different alternatives of the input data.
So we need to create a new implementation of the input contract.
We can write an instance of the InCont for the list of the InContImpl with the needed match function:

\begin{lstlisting}[language=Haskell]
newtype ListImpl = ListImpl [InContImpl]

instance InCont State ListImpl where
  match :: State -> ListImpl -> Bool
  match s (ListImpl is) = any (match s) is
\end{lstlisting}

For example, let us consider contracts of the bid-auction join and the fraud metric.
Join requires "bid.auction" and "auction.id" attributes and sets "joinedBA" property:
\begin{lstlisting}[language=Haskell]
( InContImpl (Set.singleton "bid.auction")
             Set.empty Set.empty
, InContImpl (Set.singleton "auction.id")
             Set.empty Set.empty
, OutContImpl Set.empty
              (Set.singleton "joinedBA") )
\end{lstlisting}

Fraud metric has one input contract with four alternatives (list of four InContImpl):
only bid attributes
or joined bid and auction attributes
or joined bid and person attributes
or all attributes.

We implemented a graphs generation prototype in Haskell~\footnote{https://github.com/flame-stream/halco}.
Our prototype generates all possible 6 execution graphs corresponding to the CGraph of the running example.

Note that a Semantics node set with their input contracts looks pretty similar to the declarative dataflows specification approach, e.g., SQL, because we indicate only the desired result.
However, as opposed to the SQL, user-defined operations annotated with contracts can also be used in equivalent graphs generation process, e.g., can be safely reordered.
