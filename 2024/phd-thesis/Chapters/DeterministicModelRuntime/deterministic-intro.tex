One approach to achieve determinism in distributed stream processing is strong ordering of data elements. The typical way to perform in-order processing is to set up a special buffer in front of each order-sensitive operation~\cite{Li:2008:OPN:1453856.1453890}. However, extra buffering can lead to latency growth~\cite{Zacheilas:2017:MDS:3093742.3093921}, especially if the processing pipeline contains several operations that require ordered input. 

In this chapter, we introduce an optimistic model for handling out-of-order items and achieving deterministic computation called {\em drifting state}. It requires single buffer per computational pipeline. Our model is based on the idea that state can be streamed as an ordinary element. Such approach allows us to generalize speculative computations on the arbitrary MapReduce task and makes the model stateless from the business logic point of view.

Additionally, in this chapter, we design a fault tolerance protocol on top of the drifting state technique. We show that lightweight determinism helps to ensure exactly-once guarantee for a negligible cost. Experimental study demonstrates that the implementation of our model has low overhead and can outperform alternative industrial solution under normal load conditions.

% The rest of the paper is structured as follows: in section~\ref{fs-model} we introduce the proposed model and the optimistic approach for handling out-of-order items, the implementation details of the prototype are discussed in~\ref{fs-impl} and its performance is demonstrated in~\ref{fs-experiments-section}, the relevant prior research is mentioned in~\ref{fs-related-section}, finally we discuss the results and our plans in~\ref{fs-conclusions}.